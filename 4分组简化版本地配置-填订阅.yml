port: 10808
socks-port: 10809
allow-lan: true
mode: Rule
log-level: info
external-controller: 0.0.0.0:1443
dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16   # if you don't know what it is, don't change it
  use-hosts: true                # lookup hosts and return IP record
  nameserver:
    - 223.5.5.5                  # é˜¿é‡ŒDNS
    - 223.6.6.6                  # éšä¾¿å¡«å†™ä½ å–œæ¬¢çš„DNS
  fallback:                      # concurrent request with nameserver, 
    - 8.8.8.8                    # google
    - 1.1.1.1                    # cloudflare
  fallback-filter: 
    geoip: true                  # default    
    ipcidr:                      # ips in these subnets will be considered polluted
      - 240.0.0.0/4
      
# intervalä»£è¡¨é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºs
# toleranceä»£è¡¨å®¹å·®æ—¶é—´ï¼Œå•ä½ä¸ºms
# ç”±äºåˆ†æµè§„åˆ™å¼•ç”¨äº†Githubæ–‡ä»¶ï¼Œå¦‚æœä½ çš„æœ¬åœ°ç½‘ç»œæ— æ³•è®¿é—®Githubï¼Œä½ å°†æ— æ³•è®©Clashæ­£å¸¸å·¥ä½œã€‚
# ä½ éœ€è¦å…ˆä½¿ç”¨ç¿»å¢™å·¥å…·è®©æœ¬åœ°ç½‘ç»œå‡ºå¢™ï¼Œå†å¯åŠ¨Clashæ‰èƒ½æ­£å¸¸ä¸‹è½½åˆ†æµè§„åˆ™å¹¶æ­£å¸¸å¯åŠ¨ï¼Œå¾…Clahså¯åŠ¨æˆåŠŸå¹¶æ›´æ–°å®Œè®¢é˜…èµ„æºå’Œåˆ†æµè§„åˆ™ä¹‹åï¼Œæ–¹å¯å…³é—­ä½ ä¹‹å‰æ‰“å¼€çš„ç¿»å¢™å·¥å…·ã€‚
# è¯·ä½¿ç”¨èŠ‚ç‚¹è®¢é˜…è½¬æ¢æœåŠ¡å°†æœåŠ¡å•†çš„è®¢é˜…é“¾æ¥è½¬æ¢ä¸ºClashçš„è®¢é˜…ï¼Œå¹¶è¾“å‡ºä¸ºNode Listæ ¼å¼ï¼Œä½¿ç”¨æœ¬ç®€åŒ–ç‰ˆå¯ä»¥å¿½ç•¥ã€‚
# è¯·ä½¿ç”¨èŠ‚ç‚¹è®¢é˜…è½¬æ¢å·¥å…·æä¾›çš„ä¿ç•™èŠ‚ç‚¹å’Œè¿‡æ»¤èŠ‚ç‚¹åŠŸèƒ½ï¼Œç”Ÿæˆä¸åŒåœ°åŒºçš„è®¢é˜…é“¾æ¥ï¼Œå¹¶å¡«å…¥ä¸‹æ–¹proxy-providersåŒºåŸŸï¼Œä½¿ç”¨æœ¬ç®€åŒ–ç‰ˆå¯ä»¥å¿½ç•¥ã€‚
# å…¶ä»–å†…å®¹å…·ä½“è§æ³¨é‡Šã€‚


#parsers: # array
  - reg: 'åˆ†ç»„ç®€åŒ–ç‰ˆæœ¬åœ°é…ç½®-å¡«è®¢é˜….yml'
    code: |
      module.exports.parse = async (raw, { axios, yaml, notify, console }) => {
        raw = raw.replace(/# upload=\d*; download=\d*; total=\d*; expire=\d*;*\n/gm,'')
        const url = 'æ­¤å¤„å¡«è®¢é˜…'
        let { headers:{"subscription-userinfo": si = ""}={}, status } = await axios.head(url)
        si = si.replace(/;*$/g,'')
        if (status === 200 && si) {
          return `# ${si};\n${raw}`
        }
        return raw
      }
#ä¸Šè¿°ä»£ç ä¸ºæœ¬åœ°é…ç½®é¢„å¤„ç†ä»£ç ï¼Œç›®çš„æ˜¯åœ¨æœ¬åœ°é…ç½®ä¸‹æ–¹æ˜¾ç¤ºæµé‡ä½¿ç”¨æƒ…å†µ(æ–‡æ¡£ä¸­ç§°å…¶ä¸ºï¼šè®¢é˜…ä¿¡æ¯ subscription-userinfoï¼Œå¯ä¸‹è½½curlåä½¿ç”¨curl -I 'https://example.com/subscription_url'æ¥æŸ¥çœ‹è®¢é˜…æ˜¯å¦å¸¦æœ‰æµé‡ä¿¡æ¯)


# èŠ‚ç‚¹è®¢é˜…è½¬æ¢ç½‘å€ https://api.hope140.cc

# èŠ‚ç‚¹è®¢é˜…
# é»˜è®¤æ¯å…­å°æ—¶æ›´æ–°ä¸€æ¬¡èŠ‚ç‚¹è®¢é˜…
proxy-providers:  
  ä¸€å…ƒæœºåœº:       #è¿™é‡Œåå­—æ”¹äº†ä¸‹é¢ä¹Ÿå¾—æ”¹
    type: http
    path: ./Proxy/æœºåœº.yml
    url:       #æ­¤å¤„å¡«è®¢é˜…ï¼Œæ³¨æ„ç©ºæ ¼å¯¹é½
    interval: 21600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
         
# èŠ‚ç‚¹ç»„
# é»˜è®¤æ¯åˆ†é’Ÿæµ‹è¯•ä¸€æ¬¡èŠ‚ç‚¹å»¶æ—¶
# å®¹å·®å‚æ•°æœªå¼€å¯æ—¶é»˜è®¤ä¸º0ms
proxy-groups:

  - name: ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
    type: select
    use:
      - ä¸€å…ƒæœºåœº       #è¿™é‡Œåå­—å’Œä¸Šé¢å¯¹åº”

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢

  - name: ğŸ¯ å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT
      - REJECT
       
  - name: ğŸ›‘ å¹¿å‘Šå±è”½
    type: select
    proxies:
      - REJECT 
      - DIRECT

# åˆ†æµè§„åˆ™è®¢é˜…
# é»˜è®¤æ¯äºŒåå››å°æ—¶æ›´æ–°ä¸€æ¬¡åˆ†æµè§„åˆ™
rule-providers:

  NSFW:
    type: http
    behavior: classical
    path: ./RuleSet/NSFW.yaml
    url: https://raw.githubusercontent.com/tanmoumou252/NSFW-website-rule-for-Clash/main/NSFW.yaml
    interval: 86400
    
  China:
    type: http
    behavior: classical
    path: ./RuleSet/China.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.yaml
    interval: 86400

  AdvertisingTest:
    type: http
    behavior: classical
    path: ./RuleSet/AdvertisingTest.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingTest/AdvertisingTest.yaml
    interval: 86400

  Google:
    type: http
    behavior: classical
    path: ./RuleSet/Google.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    interval: 86400

  GoogleDrive:
    type: http
    behavior: classical
    path: ./RuleSet/GoogleDrive.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GoogleDrive/GoogleDrive.yaml
    interval: 86400

  OneDrive:
    type: http
    behavior: classical
    path: ./RuleSet/OneDrive.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OneDrive/OneDrive.yaml
    interval: 86400

  Microsoft:
    type: http
    behavior: classical
    path: ./RuleSet/Microsoft.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml
    interval: 86400

  Github:
    type: http
    behavior: classical
    path: ./RuleSet/Github.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.yaml
    interval: 86400  

  Apple:
    type: http
    behavior: classical
    path: ./RuleSet/Apple.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.yaml
    interval: 86400

  Telegram:
    type: http
    behavior: classical
    path: ./RuleSet/Telegram.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    interval: 86400

  Game:
    type: http
    behavior: classical
    path: ./RuleSet/Game.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/Game.yaml
    interval: 86400

  YouTube:
    type: http
    behavior: classical
    path: ./RuleSet/YouTube.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    path: ./RuleSet/Netflix.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    interval: 86400

  Bahamut:
    type: http
    behavior: classical
    path: ./RuleSet/Bahamut.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Bahamut/Bahamut.yaml
    interval: 86400

  GlobalMedia:
    type: http
    behavior: classical
    path: ./RuleSet/GlobalMedia.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia.yaml
    interval: 86400

  Bilibili:
    type: http
    behavior: classical
    path: ./RuleSet/Bilibili.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBili/BiliBili.yaml
    interval: 86400

  ChinaMedia:
    type: http
    behavior: classical
    path: ./RuleSet/ChinaMedia.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.yaml
    interval: 86400

  Developer:
    type: http
    behavior: classical
    path: ./RuleSet/Developer.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Developer/Developer.yaml
    interval: 86400           

  Proxy:
    type: http
    behavior: classical
    path: ./RuleSet/Proxy.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/hope140/Clash/beta/Proxy.yaml
    interval: 86400         

  Download:
    type: http
    behavior: classical
    path: ./RuleSet/Download.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Download/Download.yaml
    interval: 86400    

  Lan:
    type: http
    behavior: classical
    path: ./RuleSet/Lan.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml
    interval: 86400    

  Direct:
    type: http
    behavior: classical
    path: ./RuleSet/Direct.yaml
    url: https://ghproxy.com/https://raw.githubusercontent.com/hope140/Clash/beta/Direct.yaml
    interval: 86400    



# åˆ†æµè§„åˆ™
rules:
  - RULE-SET,NSFW,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Download,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Lan,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,AdvertisingTest,ğŸ›‘ å¹¿å‘Šå±è”½
  - RULE-SET,Google,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,GoogleDrive,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,OneDrive,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Microsoft,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Apple,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Telegram,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Game,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,YouTube,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Bahamut,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Netflix,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢  
  - RULE-SET,GlobalMedia,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Bilibili,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,ChinaMedia,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Github,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Developer,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Proxy,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,China,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Direct,ğŸ¯ å…¨çƒç›´è¿
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
