port: 7890
socks-port: 7891
mixed-port: 7893
allow-lan: true
mode: Rule
log-level: info
dns:
  enable: true
  ipv6: true
  listen: 0.0.0.0:8053
  default-nameserver :
    - 1.1.1.1
    - 8.8.8.8
  enhanced-mode: fake-ip
  # é…ç½®ä¸ä½¿ç”¨fake-ipçš„åŸŸå
  fake-ip-filter:
    - '+.*'
    - '*.lan'
    - localhost.ptlogin2.qq.com
  nameserver:
    - 223.5.5.5
    - 1.1.1.1
    - 8.8.8.8
    - 114.114.114.114
    - 119.29.29.29
  fallback:   # ä¸ nameserver å†…çš„æœåŠ¡å™¨åˆ—è¡¨åŒæ—¶å‘èµ·è¯·æ±‚ï¼Œå½“è§„åˆ™ç¬¦åˆ GEOIP åœ¨ CN ä»¥å¤–æ—¶ï¼Œfallback åˆ—è¡¨å†…çš„åŸŸåæœåŠ¡å™¨ç”Ÿæ•ˆã€‚    
    - https://dns.google/dns-query
    - https://1.1.1.1/dns-query
    - tcp://8.8.8.8:53
    - tcp://8.8.4.4:53
    - tcp://208.67.222.222:443
    - tcp://208.67.220.220:443
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
    domain:
      - '+.google.com'
      - '+.googleapis.com'
      - '+.youtube.com'
      - '+.appspot.com'
      - '+.telegram.com'
      - '+.facebook.com'
      - '+.twitter.com'
      - '+.blogger.com'
      - '+.gmail.com'
      - '+.gvt1.com'
sniffer:
  enable: true
  override-destination: true
  sniff:
    http: { ports: [80, 8080] }
    tls: { ports: [443, 8443] }
  skip-domain:
    #Apple
    - 'courier.push.apple.com'
    #mi
    - 'Mijia Cloud'

# èŠ‚ç‚¹è®¢é˜…
# é»˜è®¤æ¯å…­å°æ—¶æ›´æ–°ä¸€æ¬¡èŠ‚ç‚¹è®¢é˜…
proxy-providers:  
  å…¨çƒèŠ‚ç‚¹:
    type: http
    path: ./Proxy/å…¨çƒèŠ‚ç‚¹.yaml
    url:   #å¡«å†™è®¢é˜…è¿æ¥ï¼Œæ³¨æ„ç©ºæ ¼
    interval: 21600
    #å¦å®šå¼å‰ç»æ’é™¤æ­£åˆ™,åŸºæœ¬è¡¨è¾¾å¼ä¸º^(?!åŒ¹é…æ¨¡å¼),".*?"è¡¨ç¤ºä»»æ„å­—ç¬¦.æ’é™¤åå­—å«æœ‰[æµé‡|åˆ°æœŸ|é‡ç½®]ä¸­ä»»æ„ä¸€ä¸ªçš„èŠ‚ç‚¹
    filter: "^(?!.*?[æµé‡|åˆ°æœŸ|é‡ç½®]).*?$" 
    #ç›´æ¥æ­£åˆ™åŒ¹é…æ’é™¤,å’Œä¸Šä¸€è¡Œçš„è¡¨è¾¾å¼æ˜¯ä¸€æ ·çš„ä½œç”¨,åœ¨mihomoä¸Šå¯ä»¥å·¥ä½œ,Pæ ¸ä¸æ¸…æ¥š
    exclude-filter: "æµé‡|åˆ°æœŸ|é‡ç½®"
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
      
  0.1å€ç‡: 
#è®¢é˜…å°±æ”¹httpï¼Œå’Œä¸Šé¢çš„å…¨çƒèŠ‚ç‚¹ä¸€è‡´ï¼Œå› ä¸ºä¸Šé¢å·²ç»ä¿å­˜è¿‡ä¸€æ¬¡è®¢é˜…æ–‡ä»¶äº†ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ç°æˆçš„file
    type: file                 
    path: ./Proxy/å…¨çƒèŠ‚ç‚¹.yaml   
    interval: 21600
#ä»¥0.1å€ç‡èŠ‚ç‚¹ä¸ºä¾‹,å¦‚æœåœ¨æ­¤å¤„å°±filterä¸€æ¬¡,é‚£ä¹ˆåœ¨proxy-groupsä¸­å°±å¯ä»¥å°‘æ˜¾ç¤ºä¸€ä¸ª0.1å€ç‡èŠ‚ç‚¹ç»„
#æ¢å¥è¯è¯´åœ¨è¿™é‡Œfilteræ˜¯ä½œç”¨äºåº•å±‚çš„èŠ‚ç‚¹åˆ—è¡¨,å‚è§133è¡Œ.åœ¨proxy-groupsä¸­filteråˆ™è¿˜å¯ä»¥å¥—å¨ƒä¸Šåˆ«çš„proxy-groups,å‚è§138è¡Œ
    filter: å€ç‡0.1   #å«æœ‰â€œå€ç‡0.1â€çš„èŠ‚ç‚¹æ‰ä¼šå‡ºç°
    exclude-filter: 
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300  

  HK:
    type: file
    path: ./Proxy/å…¨çƒèŠ‚ç‚¹.yaml  
    interval: 21600
    filter: ".*?[HK|é¦™æ¸¯].*?$" #æ­£å‘åŒ¹é…
    exclude-filter: 
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
             
# èŠ‚ç‚¹ç»„
# é»˜è®¤æ¯åˆ†é’Ÿæµ‹è¯•ä¸€æ¬¡èŠ‚ç‚¹å»¶æ—¶
# å®¹å·®å‚æ•°æœªå¼€å¯æ—¶é»˜è®¤ä¸º0ms
proxy-groups:
  - name: ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
    type: select
    use:
      - å…¨çƒèŠ‚ç‚¹ 

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - DIRECT
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢    

  - name: ğŸ“² ç”µæŠ¥æ¶ˆæ¯
    type: select    
    proxies:
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
      - ğŸ‡­ğŸ‡°HK             #133è¡Œ
      - ğŸ‡­ğŸ‡°HK_no_X        #138è¡Œ
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ”¯ æ•…éšœè½¬ç§»
     
  - name: ğŸ® æ¸¸æˆå¹³å°
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿     
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢       

  - name: "ğŸ‡­ğŸ‡°HK"
    type: select
    use:        
      - "HK"    #ä½¿ç”¨çš„æ˜¯92è¡Œproxy-providersä¸­çš„HK æ‰€ä»¥å­—æ®µæ˜¯"use",è¡¨ç¤ºæ‰‹åŠ¨é€‰æ‹©

  - name: "ğŸ‡­ğŸ‡°HK_no_X"
    type: select
    filter: "^(?!.*?[0x|0.1x]).*?$"    #æ’é™¤å€ç‡
    exclude-filter: "[0x|0.1x]"   #æ’é™¤å€ç‡
    use:
      - "HK"     #åŠ ä¸Šè¿™ä¸ª,è¡¨ç¤ºé™¤äº†æ²¿ç”¨çš„ä¹‹å¤–,è¿˜å¯ä»¥åœ¨æ’é™¤å€ç‡åçš„èŠ‚ç‚¹ä¸­æ‰‹åŠ¨é€‰æ‹©
    proxies:        
      - "ğŸ‡­ğŸ‡°HK"   #ğŸ‡­ğŸ‡°HKå¥—å¨ƒäº†,æ‰€ä»¥ç”¨çš„å­—æ®µæ˜¯133è¡Œçš„proxies,è¡¨ç¤ºæ²¿ç”¨ğŸ‡­ğŸ‡°HKçš„é€‰æ‹©

#ä»¥ä¸Šæ³¨é‡Šè¯´äººè¯å°±æ˜¯,æˆ‘è¦ç­›é€‰HKèŠ‚ç‚¹,åœ¨æ­¤åŸºç¡€ä¸Š,å†æ¬¡ç­›é€‰HKä¸­çš„æŸäº›èŠ‚ç‚¹

  - name: ğŸ¯ å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT
      - ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
             
  - name: ğŸ›‘ éšç§æ‹¦æˆª
    type: select
    proxies:
      - REJECT
      - DIRECT 
      
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - å…¨çƒèŠ‚ç‚¹

  - name: ğŸ”¯ æ•…éšœè½¬ç§»
    type: fallback
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - å…¨çƒèŠ‚ç‚¹   
     

# åˆ†æµè§„åˆ™è®¢é˜…
# å·²æ›¿æ¢ä¸ºcdnåŠ é€Ÿurl
# é»˜è®¤æ¯äºŒåå››å°æ—¶æ›´æ–°ä¸€æ¬¡åˆ†æµè§„åˆ™
rule-providers:

  NSFW:
    type: http
    behavior: classical
    path: ./RuleSet/NSFW.yaml
    url: https://cdn.jsdelivr.net/gh/tanmoumou252/NSFWruleset/NSFW.yaml
    interval: 86400
    
  China:
    type: http
    behavior: classical
    path: ./RuleSet/China.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/China/China.yaml
    interval: 86400

  AdvertisingTest:
    type: http
    behavior: classical
    path: ./RuleSet/AdvertisingTest.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AdvertisingTest/AdvertisingTest.yaml
    interval: 86400

  Google:
    type: http
    behavior: classical
    path: ./RuleSet/Google.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Google/Google.yaml
    interval: 86400

  GoogleDrive:
    type: http
    behavior: classical
    path: ./RuleSet/GoogleDrive.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GoogleDrive/GoogleDrive.yaml
    interval: 86400

  OneDrive:
    type: http
    behavior: classical
    path: ./RuleSet/OneDrive.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OneDrive/OneDrive.yaml
    interval: 86400

  Microsoft:
    type: http
    behavior: classical
    path: ./RuleSet/Microsoft.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft.yaml
    interval: 86400

  Github:
    type: http
    behavior: classical
    path: ./RuleSet/Github.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml
    interval: 86400  

  Apple:
    type: http
    behavior: classical
    path: ./RuleSet/Apple.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple.yaml
    interval: 86400

  Telegram:
    type: http
    behavior: classical
    path: ./RuleSet/Telegram.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml
    interval: 86400

  Game:
    type: http
    behavior: classical
    path: ./RuleSet/Game.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/Game.yaml
    interval: 86400

  YouTube:
    type: http
    behavior: classical
    path: ./RuleSet/YouTube.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    path: ./RuleSet/Netflix.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml
    interval: 86400

  Bahamut:
    type: http
    behavior: classical
    path: ./RuleSet/Bahamut.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Bahamut/Bahamut.yaml
    interval: 86400

  GlobalMedia:
    type: http
    behavior: classical
    path: ./RuleSet/GlobalMedia.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GlobalMedia/GlobalMedia.yaml
    interval: 86400

  Bilibili:
    type: http
    behavior: classical
    path: ./RuleSet/Bilibili.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BiliBili/BiliBili.yaml
    interval: 86400

  ChinaMedia:
    type: http
    behavior: classical
    path: ./RuleSet/ChinaMedia.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMedia/ChinaMedia.yaml
    interval: 86400

  Developer:
    type: http
    behavior: classical
    path: ./RuleSet/Developer.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Developer/Developer.yaml
    interval: 86400 

  Download:
    type: http
    behavior: classical
    path: ./RuleSet/Download.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Download/Download.yaml
    interval: 86400    

  Lan:
    type: http
    behavior: classical
    path: ./RuleSet/Lan.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan.yaml
    interval: 86400    

  Lan_CN:
    type: http
    behavior: classical
    path: ./RuleSet/Lan_CN.yaml
    url: https://cdn.jsdelivr.net/gh/tanmoumou252/NSFWruleset/Lan_CN.yaml
    interval: 86400

  Firefox:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/tanmoumou252/firefoxruleset/Firefox.yaml
    path: ./RuleSet/Firefox.yaml
    interval: 86400

  GPT_AI:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/tanmoumou252/NSFWruleset/GPT_AI.yaml
    path: ./RuleSet/GPT_AI.yaml
    interval: 86400

  Twitter:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script/rule/Clash/Twitter/Twitter.yaml
    path: ./RuleSet/Twitter.yaml
    interval: 86400

# åˆ†æµè§„åˆ™
rules:
  - RULE-SET,NSFW,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Download,DIRECT
  - RULE-SET,Lan,DIRECT
  - RULE-SET,AdvertisingTest,ğŸ›‘ éšç§æ‹¦æˆª
  - RULE-SET,Google,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,GoogleDrive,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,OneDrive,DIRECT
  - RULE-SET,Microsoft,DIRECT
  - RULE-SET,Apple,DIRECT
  - RULE-SET,Telegram,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Game,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,YouTube,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Bahamut,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Netflix,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,GlobalMedia,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Bilibili,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,ChinaMedia,DIRECT
  - RULE-SET,Github,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Developer,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,GPT_AI,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Twitter,ğŸš€ æ‰‹åŠ¨åˆ‡æ¢
  - RULE-SET,Lan_CN,DIRECT  
  - RULE-SET,China,DIRECT
  - RULE-SET,Firefox,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
